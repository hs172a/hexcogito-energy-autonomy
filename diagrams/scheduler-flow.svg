<svg xmlns="http://www.w3.org/2000/svg" width="800" height="500" viewBox="0 0 800 500">
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#2c5e8e" />
    </marker>
    <style>
      .box { fill: #e8f4f8; stroke: #2c5e8e; stroke-width: 2; rx: 6; ry: 6; }
      .diamond { fill: #fff8e1; stroke: #f9a825; stroke-width: 2; }
      .text { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; font-size: 14px; fill: #333; }
      .label { font-size: 12px; fill: #666; }
      .arrow { stroke: #2c5e8e; stroke-width: 2; marker-end: url(#arrowhead); }
      .thin-arrow { stroke: #666; stroke-width: 1; marker-end: url(#arrowhead); }
      .connector { font-family: monospace; font-size: 12px; fill: #666; }
    </style>
  </defs>

  <rect width="100%" height="100%" fill="#fff"/>

  <!-- Start -->
  <g transform="translate(350, 30)">
    <rect class="box" x="0" y="0" width="100" height="40" />
    <text class="text" x="50" y="25" text-anchor="middle">Start</text>
  </g>

  <!-- Arrow to Inputs -->
  <line class="arrow" x1="400" y1="70" x2="400" y2="110" />
  <text class="label" x="420" y="90">inputs</text>

  <!-- Inputs box -->
  <g transform="translate(320, 120)">
    <rect class="box" x="0" y="0" width="160" height="100" />
    <text class="text" x="80" y="25" text-anchor="middle">Inputs</text>
    <text class="text" x="10" y="45">• battery_soc</text>
    <text class="text" x="10" y="65">• solar_forecast</text>
    <text class="text" x="10" y="85">• usdc_balance</text>
  </g>

  <!-- Arrow to Decision -->
  <line class="arrow" x1="400" y1="220" x2="400" y2="270" />

  <!-- Decision diamond -->
  <g transform="translate(400, 250)">
    <polygon class="diamond" points="0,-40 60,0 0,40 -60,0" />
    <text class="text" x="0" y="5" text-anchor="middle">Excess energy?</text>
    <text class="label" x="0" y="-50" text-anchor="middle">battery_soc &gt;0.8</text>
    <text class="label" x="0" y="-35" text-anchor="middle">&amp; solar_forecast &gt;0.7</text>
  </g>

  <!-- Yes branch -->
  <line class="arrow" x1="460" y1="250" x2="550" y2="250" />
  <text class="label" x="505" y="240" text-anchor="middle">Yes</text>
  <g transform="translate(540, 220)">
    <rect class="box" x="0" y="0" width="120" height="60" fill="#e8f5e9" stroke="#388e3c" />
    <text class="text" x="60" y="30" text-anchor="middle">Sell Energy</text>
  </g>
  <!-- Arrow from Sell Energy to End -->
  <line class="arrow" x1="600" y1="250" x2="700" y2="250" />
  <text class="label" x="650" y="240" text-anchor="middle"></text>

  <!-- No branch -->
  <line class="arrow" x1="340" y1="250" x2="200" y2="250" />
  <text class="label" x="270" y="240" text-anchor="middle">No</text>
  <!-- Second decision -->
  <g transform="translate(200, 250)">
    <polygon class="diamond" points="0,-40 60,0 0,40 -60,0" />
    <text class="text" x="0" y="5" text-anchor="middle">Emergency?</text>
    <text class="label" x="0" y="-50" text-anchor="middle">battery_soc &lt;0.2</text>
    <text class="label" x="0" y="-35" text-anchor="middle">&amp; usdc_balance low</text>
  </g>

  <!-- Emergency: Yes -->
  <line class="arrow" x1="260" y1="250" x2="320" y2="180" />
  <text class="label" x="290" y="215" text-anchor="middle">Yes</text>
  <g transform="translate(300, 130)">
    <rect class="box" x="0" y="0" width="140" height="80" fill="#ffebee" stroke="#c62828" />
    <text class="text" x="70" y="30" text-anchor="middle">Run inference</text>
    <text class="text" x="70" y="50" text-anchor="middle">for income</text>
  </g>
  <!-- Connect to End -->
  <line class="arrow" x1="370" y1="170" x2="700" y2="140" />

  <!-- Emergency: No -->
  <line class="arrow" x1="140" y1="250" x2="80" y2="250" />
  <text class="label" x="110" y="240" text-anchor="middle">No</text>
  <g transform="translate(20, 220)">
    <rect class="box" x="0" y="0" width="120" height="60" fill="#e3f2fd" stroke="#1565c0" />
    <text class="text" x="60" y="30" text-anchor="middle">Run inference</text>
    <text class="text" x="60" y="50" text-anchor="middle">(balanced)</text>
  </g>
  <!-- Arrow from Balanced to End -->
  <line class="arrow" x1="80" y1="250" x2="100" y2="250" />
  <line class="arrow" x1="100" y1="250" x2="700" y2="250" />

  <!-- End -->
  <g transform="translate(680, 120)">
    <rect class="box" x="0" y="0" width="100" height="40" />
    <text class="text" x="50" y="25" text-anchor="middle">End</text>
  </g>

</svg>